#!/usr/bin/make -f

export MONO_SHARED_DIR=$(CURDIR)

include /usr/share/cdbs/1/rules/debhelper.mk
include /usr/share/cdbs/1/rules/simple-patchsys.mk
include /usr/share/cdbs/1/class/gnome.mk

LDFLAGS+=-Wl,-z,defs -Wl,-O1 -Wl,--as-needed
DEB_CONFIGURE_EXTRA_FLAGS := --disable-scrollkeeper
DEB_INSTALL_DOCS_ALL := README NEWS
DEB_CONFIGURE_EXTRA_FLAGS += --with-mono-addins=system

common-configure-indep::
	mkdir -p $(MONO_SHARED_DIR)/.wapi

install/tomboy::
	mkdir -p debian/tomboy/usr/share/pixmaps
	uudecode debian/tomboy-16.xpm.uu && mv tomboy-16.xpm debian/tomboy/usr/share/pixmaps
	uudecode debian/tomboy-32.xpm.uu && mv tomboy-32.xpm debian/tomboy/usr/share/pixmaps
	mkdir -p debian/tomboy/usr/lib/tomboy/addins
	cp debian/PrintNotes.dll.config debian/tomboy/usr/lib/tomboy/addins
	rm -rf debian/tomboy/usr/lib/tomboy/libprintnotes.la
	rm -rf debian/tomboy/usr/lib/tomboy/libtomboy.la

common-binary-predeb-arch::
	dh_clifixperms
	dh_clideps -d

clean::
	rm -rf $(MONO_SHARED_DIR)/.wapi

