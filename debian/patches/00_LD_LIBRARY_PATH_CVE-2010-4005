Description: Fix unsafe LD_LIBRARY_PATH setting (CVE-2010-4005)
Author: Luis Medinas <lmedinas@gnome.org>
Origin: https://bugzilla.gnome.org/show_bug.cgi?id=635614
Bug-Debian: http://bugs.debian.org/cgi-bin/bugreport.cgi?bug=605096
Bug-Upstream: https://bugzilla.gnome.org/show_bug.cgi?id=635614
Forwarded: not-needed

Index: tomboy.git/Tomboy/tomboy.in
===================================================================
--- tomboy.git.orig/Tomboy/tomboy.in	2010-11-29 01:10:11.170557627 +0000
+++ tomboy.git/Tomboy/tomboy.in	2010-11-29 01:09:46.128629088 +0000
@@ -3,13 +3,13 @@
 if [ "x$PWD" = "x@srcdir@" ] ; then
     echo "*** Running uninstalled @target@ ***"
 
-    export LD_LIBRARY_PATH="../libtomboy/.libs${LD_LIBRARY_PATH+:$LD_LIBRARY_PATH}:./Addins/PrintNotes/.libs"
+    export LD_LIBRARY_PATH="../libtomboy/.libs${LD_LIBRARY_PATH:+:$LD_LIBRARY_PATH}:./Addins/PrintNotes/.libs"
     export TOMBOY_WRAPPER_PATH="$PWD/@wrapper@"
     export MONO_PATH=$MONO_PATH:./Addins:../Mono.Addins/Mono.Addins:../Mono.Addins/Mono.Addins.Setup:../Mono.Addins/Mono.Addins.Gui
 
     THIS_EXE="--debug ./@target@"
 else
-    export LD_LIBRARY_PATH="@pkglibdir@${LD_LIBRARY_PATH+:$LD_LIBRARY_PATH}"
+    export LD_LIBRARY_PATH="@pkglibdir@${LD_LIBRARY_PATH:+:$LD_LIBRARY_PATH}"
     export MONO_PATH=$MONO_PATH:@pkglibdir@:@pkglibdir@/addins
     export TOMBOY_WRAPPER_PATH="@bindir@/@wrapper@"
 
Index: tomboy.git/Tomboy/tomboy-panel.in
===================================================================
--- tomboy.git.orig/Tomboy/tomboy-panel.in	2010-11-29 01:10:10.770526817 +0000
+++ tomboy.git/Tomboy/tomboy-panel.in	2010-11-29 01:10:00.929768958 +0000
@@ -1,6 +1,6 @@
 #!/usr/bin/env bash
 
-export LD_LIBRARY_PATH="@pkglibdir@${LD_LIBRARY_PATH+:$LD_LIBRARY_PATH}"
+export LD_LIBRARY_PATH="@pkglibdir@${LD_LIBRARY_PATH:+:$LD_LIBRARY_PATH}"
 export MONO_PATH=$MONO_PATH:@pkglibdir@:@pkglibdir@/addins
 export TOMBOY_WRAPPER_PATH="@bindir@/@wrapper@"
 TOMBOY_CONFIG_DIR="${XDG_CONFIG_HOME:-$HOME/.config}/tomboy"
